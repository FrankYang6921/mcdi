# 这就是MCDI。
一个用来一键生成红石音乐的Python库。

## 开始
要运行这个库，你需要：
+ Python 3.8 或更新
  + Python库：mido
  + Python库：pillow
这个库通过生成mcfunction文件来制作红石音乐。因此只支持**Minecraft（Java版）1.13 或更新**。

### 如何安装运行环境？
先[安装Python](https://www.liaoxuefeng.com/wiki/1016959663602400/1016959856222624) ，然后键入`pip install mido`和`pip install pillow`。


## 作品展示
+ MIDIOut++生成——
[打上花火](https://www.bilibili.com/video/BV1Hz4y1f7FW) 丨[Lemon](https://www.bilibili.com/video/BV1954y1U7C7)
+ 原版资源包生成——
[千本樱](https://www.bilibili.com/video/BV1Hz4y1f7FW) 丨[恋爱循环](https://www.bilibili.com/video/BV1Na4y1i7tV)

## 教程
如果您想使用这个工具，请先满足“开始”中的运行环境。满足运行环境后再阅读后面的教程。

请打开`cmd`，键入`cd <这个帮助文件所在的目录>`，然后键入`python main.py`，并输入命令行参数：
+ `--type`：‘rt’或‘ig’，分别对应原版资源包和实时生成。
+ `--midi`：MIDI文件的路径。
+ `--save`：世界存档的路径。
+ `--plugins`：要使用的插件，详情见下。
+ `--middles`：要使用的中间件，同插件。
+ `--tick`：刻速率，即TPS，N刻每秒。
+ `--frontend`：要使用的前端，详情见下。
+ `--kwargs`：要添加的额外参数。详情见下。

**注：含空格的参数都须加上双引号或单引号。尖括号的部分需要您来填写（实际填写时不需要尖括号）。**

### 插件/中间件的格式：
格式：`"<插件包>.<插件>(<参数值>, <参数名>=<参数值>, ...), <插件包>.<插件>(..."`；关于如何使用插件的参数，请参阅那个插件的说明。

### 前端的格式：
格式：`"<前端包>.<前端>"`；暂不支持前端的参数。

### 额外参数的格式：
格式：`'<参数名>': <参数值>, '<参数名>': <参数值>, ...`；可用的额外参数与其默认值见下，您永远不应该使用没有在下方列出的额外参数。
+ blank_ticks = 0
    + 在音乐开始前空多少刻。
+ tick_rate = 20
    + **这个参数不应被使用。**
+ tick_scale = 1
    + 音乐的播放倍速。
+ single_tick_limit = 128
    + 最大音符数量上限。
+ wrap_length = 128
    + 每多少格换行一次。
+ _use_function_array = False
    + 永远使用基于函数的CB板。
+ _auto_function_array = False
    + 自动使用基于函数的CB板。
    
注：上两个参数互斥。

原版资源包生成器还有特殊的额外参数。
+ prog_enabled = True
    + 使用乐器。
+ gvol_enabled = True
    + 使用全局音量。
+ phase_enabled = True
    + 使用相位。
+ pitch_enabled = False
    + 使用弯音轮。
+ volume_factor = 1
    + 音量的倍率。
+ pitch_factor = 2
    + 弯音轮的倍率。
+ pitch_base = 8192
    + 弯音轮的基准值。
    
示例：`python main.py --midi "Only My Railgun.mid" --save ".minecraft/saves/MCDI" --plugins "piano.PianoRoll(), piano.PianoRollFirework()" --kwargs "'single_tick_limit': 64"`，这个命令会读取Only My Railgun.mid，把音乐制作进存档".minecraft/saves/MCDI"，使用piano.PianoRoll和piano.PianoRollFirework两个插件（没有参数），并且每一刻只允许64个音符。

## 前端（适用于原版资源包）
**注：a.b中，a是前端包名，b是前端名。**
+ wxv2.WorkerXG：生成可以使用WorkerXG资源包播放的音乐。音质（在资源包中）最好。
+ soma.Soma：生成可以使用Soma(v20α)资源包播放的音乐。音质（在资源包中）较好。
+ vanilla.Vanilla：生成使用原版音色，不需要资源包播放的音乐。音质（在资源包中）最差。
+ mcrg.MCRG：生成可以使用MCRG生成的资源包播放的音乐。可以类比成音MAD。

## 实时生成（适用于MIDIOut++）
~~让前端滚蛋！~~我们编写了一个[MIDIOut++](https://github.com/FrankYang6921/midioutpp) 模组，这样您就可以通过MIDI设备播放音乐（详情请点击链接）。要运行这个模组，你需要安装了Fabric Loader和Fabric API的Minecraft 1.16.x。

## 内置插件
**注：形如`lyric.py`的是插件包名，其子项是插件名。**
+ `lyric.py`
    + Lyric：Lyric generated by .lrc files, useful for video making.
+ `piano.py`
    + PianoRoll：生成一个钢琴卷。配合下面两个插件更好。*Just for fun:)*
    + PianoRollFirework：为钢琴卷添加烟花，用于做视频。
    + PianoRollRenderer：为钢琴卷添加特效，用于做视频。
        + LineFunctionPreset：用直线连接两个音符。
        + PowerFunctionPreset：用抛物线连接两个音符。
        + HelixFunctionPreset：用螺旋线连接两个音符。
        + OrbitFunctionPreset：用弧线连接两个音符。
+ `title.py`
    + MainTitle：音乐首尾的标题，用于做视频。
    + CopyTitle：贯穿音乐的标题，用于做视频。
+ `tweaks.py`
    + Viewport：一般的固定/初始视角，用于做视频。
    + PigPort：骑猪的固定/初始时间，用于做视频。
    + ProgressBar：显示乐曲的进度。用于做视频。
    + FixedTime：在播放音乐时保持时间不变动。
    + FixedRain：在播放音乐时保证不下雨/打雷。
    
*\[ 持续添加中！ \]*

## 内置中间件
**注：形如`lyric.py`的是中间件包名，其子项是中间件名。**

*\[ 尚未完工 \]*

## 授权
MCDI 是由kworker(FrankYang6921)制作，遵从GPLv3协议的自由软件。本软件没有担保。你可以前往红石音乐俱乐部或Minecraft视听俱乐部（591318869或1129026982）或加作者QQ（3450123872）以获取帮助。
